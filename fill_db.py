import psycopg2
from config import DB_CONFIG

# --- –¢–µ–º—ã –∏ –≤–æ–ø—Ä–æ—Å—ã ---
surveys = {
    "–ú—É–∑—ã–∫–∞": [
        ("–ö–∞–∫–æ–π –∂–∞–Ω—Ä –º—É–∑—ã–∫–∏ –≤—ã —á–∞—â–µ –≤—Å–µ–≥–æ —Å–ª—É—à–∞–µ—Ç–µ?", ["–†–æ–∫", "–ü–æ–ø", "–î–∂–∞–∑", "–ö–ª–∞—Å—Å–∏–∫–∞"], "single"),
        ("–ì–¥–µ –≤—ã –æ–±—ã—á–Ω–æ —Å–ª—É—à–∞–µ—Ç–µ –º—É–∑—ã–∫—É?", ["–í –º–∞—à–∏–Ω–µ", "–î–æ–º–∞", "–ù–∞ –∫–æ–Ω—Ü–µ—Ä—Ç–∞—Ö"], "multiple"),
        ("–ü–æ–ª—å–∑—É–µ—Ç–µ—Å—å –ª–∏ –≤—ã —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –ø–æ—Å–µ—â–∞–µ—Ç–µ –∫–æ–Ω—Ü–µ—Ä—Ç—ã?", ["–†–∞–∑ –≤ –º–µ—Å—è—Ü", "–†–∞–∑ –≤ –≥–æ–¥", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–ö–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∞–º –±–ª–∏–∂–µ?", ["–ì–∏—Ç–∞—Ä–∞", "–ü–∏–∞–Ω–∏–Ω–æ", "–ë–∞—Ä–∞–±–∞–Ω—ã", "–í–æ–∫–∞–ª"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –¥–ª—è —Å–µ–±—è –Ω–æ–≤—É—é –º—É–∑—ã–∫—É?", ["–°–æ–≤–µ—Ç—ã –¥—Ä—É–∑–µ–π", "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ Spotify", "–°–æ—Ü—Å–µ—Ç–∏", "–†–∞–¥–∏–æ"], "multiple"),
        ("–í –∫–∞–∫–æ–º –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–∏ –±—ã–ª–∞ –ª—É—á—à–∞—è –º—É–∑—ã–∫–∞?", ["1980-–µ", "1990-–µ", "2000-–µ", "–ü–æ—Å–ª–µ 2010"], "single"),
        ("–ö–∞–∫–æ–π —É –≤–∞—Å –ª—é–±–∏–º—ã–π —Ä–æ—Å—Å–∏–π—Å–∫–∏–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å?", ["–ë–∏-2", "–ó–µ–º—Ñ–∏—Ä–∞", "–ú–æ–Ω–µ—Ç–æ—á–∫–∞", "Miyagi"], "single"),
        ("–í—ã —Å–ª—É—à–∞–µ—Ç–µ –º—É–∑—ã–∫—É –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —É—á—ë–±—ã?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ú—É–∑—ã–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single")
    ],

    "–§–∏–ª—å–º—ã": [
        ("–ö–∞–∫–æ–π –∂–∞–Ω—Ä —Ñ–∏–ª—å–º–æ–≤ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?", ["–ö–æ–º–µ–¥–∏—è", "–î—Ä–∞–º–∞", "–ë–æ–µ–≤–∏–∫", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"], "multiple"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã —Ö–æ–¥–∏—Ç–µ –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä?", ["–†–∞–∑ –≤ –º–µ—Å—è—Ü", "–†–∞–∑ –≤ –≥–æ–¥", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–ì–¥–µ –≤—ã –æ–±—ã—á–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∏–ª—å–º—ã?", ["Netflix", "–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä", "–ü–∏—Ä–∞—Ç—Å–∫–∏–µ —Å–∞–π—Ç—ã", "YouTube"], "multiple"),
        ("–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∏–ª—å–º—ã?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–π –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∏–ª—å–º –≤–∞–º –∑–∞–ø–æ–º–Ω–∏–ª—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?", ["–ë—Ä–∞—Ç", "–ò—Ä–æ–Ω–∏—è —Å—É–¥—å–±—ã", "–î–≤–∏–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö", "–°—Ç–∞–ª–∫–µ—Ä"], "single"),
        ("–° –∫–µ–º –≤—ã –æ–±—ã—á–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∏–ª—å–º—ã?", ["–í –æ–¥–∏–Ω–æ—á–∫—É", "–° —Å–µ–º—å—ë–π", "–° –¥—Ä—É–∑—å—è–º–∏", "–° –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º"], "multiple"),
        ("–ö–∞–∫–æ–π —Ñ–∏–ª—å–º –≤—ã –±—ã –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª–∏ –≤—Å–µ–º?", ["–ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä", "–§–æ—Ä—Ä–µ—Å—Ç –ì–∞–º–ø", "–ù–∞—á–∞–ª–æ", "–ú–∞—Ç—Ä–∏—Ü–∞"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–µ—Ä–∏–∞–ª—ã?", ["–ö–∞–∂–¥—ã–π –¥–µ–Ω—å", "–ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é", "–†–µ–¥–∫–æ", "–ù–µ —Å–º–æ—Ç—Ä—é"], "single"),
        ("–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å–º—ã?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–π –∞–∫—Ç—ë—Ä –≤–∞–º –±–ª–∏–∂–µ –ø–æ –¥—É—Ö—É?", ["–î–∏ –ö–∞–ø—Ä–∏–æ", "–ö–∏–∞–Ω—É –†–∏–≤–∑", "–¢–æ–º –•–∞—Ä–¥–∏", "–î–∂–æ–Ω–Ω–∏ –î–µ–ø–ø"], "single")
    ],

    "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": [
        ("–ö–∞–∫–æ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –≤—ã –ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å?", ["Windows", "Linux", "macOS", "–î—Ä—É–≥–∞—è"], "single"),
        ("–ö–∞–∫–æ–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?", ["Android", "iPhone"], "single"),
        ("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã —É–º–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É?", ["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–° –æ–ø–∞—Å–µ–Ω–∏–µ–º"], "single"),
        ("–†–∞–±–æ—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —É–¥–∞–ª—ë–Ω–Ω–æ?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ —Å–≤–æ–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞?", ["–†–∞–∑ –≤ –≥–æ–¥", "–†–∞–∑ –≤ 3 –≥–æ–¥–∞", "–†–µ–¥–∫–æ"], "single"),
        ("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã –æ–±–ª–∞—á–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–π –±—Ä–∞—É–∑–µ—Ä –≤–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π?", ["Chrome", "Firefox", "Edge", "Safari"], "single"),
        ("–ü–æ–ª—å–∑—É–µ—Ç–µ—Å—å –ª–∏ –≤—ã VPN?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã, —á—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–µ–ª–∞—é—Ç –ª—é–¥–µ–π —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ?", ["–î–∞", "–ù–µ—Ç", "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —á–µ–ª–æ–≤–µ–∫–∞"], "single")
    ],

    "–°–ø–æ—Ä—Ç": [
        ("–ó–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å –ª–∏ –≤—ã —Å–ø–æ—Ä—Ç–æ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–π –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞ –≤–∞–º –±–ª–∏–∂–µ?", ["–§—É—Ç–±–æ–ª", "–ë–µ–≥", "–§–∏—Ç–Ω–µ—Å", "–ü–ª–∞–≤–∞–Ω–∏–µ"], "multiple"),
        ("–°–º–æ—Ç—Ä–∏—Ç–µ –ª–∏ –≤—ã —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–°–ª–µ–¥–∏—Ç–µ –ª–∏ –≤—ã –∑–∞ –û–ª–∏–º–ø–∏–π—Å–∫–∏–º–∏ –∏–≥—Ä–∞–º–∏?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç–µ—Å—å?", ["–ö–∞–∂–¥—ã–π –¥–µ–Ω—å", "3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é", "–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é", "–†–µ–¥–∫–æ"], "single"),
        ("–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—ã–µ –∏–ª–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞?", ["–ö–æ–º–∞–Ω–¥–Ω—ã–µ", "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ"], "single"),
        ("–ü–æ—Å–µ—â–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–ø–æ—Ä—Ç–∑–∞–ª?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–ø–æ—Ä—Ç –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∂–∏–∑–Ω–∏?", ["–î–∞", "–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ù–µ—Ç"], "single"),
        ("–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω –¥–ª—è –≤–∞—Å –ø—Ä–∏–º–µ—Ä?", ["–†–æ–Ω–∞–ª–¥—É", "–ë–æ–ª—Ç", "–§–µ–¥–µ—Ä–µ—Ä", "–•–∞–±–∏–±"], "single")
    ],

    "–ï–¥–∞": [
        ("–ö–∞–∫—É—é –∫—É—Ö–Ω—é –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?", ["–ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è", "–Ø–ø–æ–Ω—Å–∫–∞—è", "–†—É—Å—Å–∫–∞—è", "–ú–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∞—è"], "multiple"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç–µ –µ–¥—É –Ω–∞ –¥–æ–º?", ["–ö–∞–∂–¥—ã–π –¥–µ–Ω—å", "–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç—å?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫–æ–µ –≤–∞—à–µ –ª—é–±–∏–º–æ–µ –±–ª—é–¥–æ?", ["–ü–∏—Ü—Ü–∞", "–ü–∞—Å—Ç–∞", "–ë–æ—Ä—â", "–°—É—à–∏"], "single"),
        ("–°–ª–µ–¥–∏—Ç–µ –ª–∏ –≤—ã –∑–∞ –ø–∏—Ç–∞–Ω–∏–µ–º?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–°–∫–æ–ª—å–∫–æ —á–∞—à–µ–∫ –∫–æ—Ñ–µ –≤—ã –ø—å—ë—Ç–µ –≤ –¥–µ–Ω—å?", ["0", "1‚Äì2", "3‚Äì5", "–ë–æ–ª–µ–µ 5"], "single"),
        ("–ü—Ä–æ–±–æ–≤–∞–ª–∏ –ª–∏ –≤—ã –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å—Ç–≤–æ?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã –æ—Å—Ç—Ä—ã–µ –±–ª—é–¥–∞?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ì–æ—Ç–æ–≤–∏—Ç–µ –ª–∏ –≤—ã –¥–æ–º–∞ —á–∞—â–µ, —á–µ–º –µ–¥–∏—Ç–µ –≤–Ω–µ?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ß—Ç–æ –≤—ã –æ–±—ã—á–Ω–æ –µ–¥–∏—Ç–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫?", ["–ö–∞—à–∞", "–Ø–∏—á–Ω–∏—Ü–∞", "–¢–æ—Å—Ç—ã", "–ù–µ –∑–∞–≤—Ç—Ä–∞–∫–∞—é"], "single")
    ],
    "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è": [
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –ø—É—Ç–µ—à–µ—Å—Ç–≤—É–µ—Ç–µ?", ["–ö–∞–∂–¥—ã–π –≥–æ–¥", "–†–∞–∑ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–ß—Ç–æ –≤–∞–º –±–ª–∏–∂–µ ‚Äî –º–æ—Ä–µ –∏–ª–∏ –≥–æ—Ä—ã?", ["–ú–æ—Ä–µ", "–ì–æ—Ä—ã"], "single"),
        ("–ü—É—Ç–µ—à–µ—Å—Ç–≤—É–µ—Ç–µ –ª–∏ –≤—ã –∑–∞ –≥—Ä–∞–Ω–∏—Ü—É?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –æ—Ç–¥—ã—Ö –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏?", ["–û—Ç–¥—ã—Ö", "–ê–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä–∏–∑–º"], "single"),
        ("–ö–∞–∫–æ–π –≤–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?", ["–°–∞–º–æ–ª—ë—Ç", "–ü–æ–µ–∑–¥", "–ê–≤—Ç–æ", "–ê–≤—Ç–æ–±—É—Å"], "single"),
        ("–ß—Ç–æ –≤—ã –±–µ—Ä—ë—Ç–µ –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ?", ["–¢–µ–ª–µ—Ñ–æ–Ω", "–î–æ–∫—É–º–µ–Ω—Ç—ã", "–ö–∞–º–µ—Ä—É", "–ï–¥—É"], "multiple"),
        ("–° –∫–µ–º –≤—ã —á–∞—â–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤—É–µ—Ç–µ?", ["–û–¥–∏–Ω", "–° –¥—Ä—É–∑—å—è–º–∏", "–° —Å–µ–º—å—ë–π", "–° –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º"], "single"),
        ("–ö–∞–∫–æ–π –≥–æ—Ä–æ–¥ –≤–∞–º –∑–∞–ø–æ–º–Ω–∏–ª—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?", ["–ü–∞—Ä–∏–∂", "–¢–æ–∫–∏–æ", "–°—Ç–∞–º–±—É–ª", "–†–∏–º"], "single"),
        ("–•–æ—Ç–µ–ª–∏ –±—ã –≤—ã –∂–∏—Ç—å –≤ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω–µ?", ["–î–∞", "–ù–µ—Ç", "–ù–µ –∑–Ω–∞—é"], "single"),
        ("–ö–∞–∫ –≤—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ –º–µ—Å—Ç–æ –ø–æ–µ–∑–¥–∫–∏?", ["–°–æ–≤–µ—Ç –¥—Ä—É–∑–µ–π", "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç", "–¶–µ–Ω–∞ –±–∏–ª–µ—Ç–æ–≤", "–°–ª—É—á–∞–π–Ω–æ"], "multiple"),
    ],

    "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": [
        ("–ì–¥–µ –≤—ã —É—á–∏—Ç–µ—Å—å –∏–ª–∏ —É—á–∏–ª–∏—Å—å?", ["–®–∫–æ–ª–∞", "–ö–æ–ª–ª–µ–¥–∂", "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç", "–°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω–µ?", ["–•–æ—Ä–æ—à–µ–µ", "–°—Ä–µ–¥–Ω–µ–µ", "–ü–ª–æ—Ö–æ–µ"], "single"),
        ("–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å –æ–±—É—á–µ–Ω–∏—è?", ["–î–∞", "–ù–µ –æ—á–µ–Ω—å", "–ù–µ—Ç"], "single"),
        ("–ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ª–∏ –≤—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ?", ["–î–∞", "–ù–µ—Ç", "–ù–µ –∑–Ω–∞—é"], "single"),
        ("–ö–∞–∫ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ —É—á–∏—Ç—å—Å—è?", ["–û–Ω–ª–∞–π–Ω", "–û—Ñ—Ñ–ª–∞–π–Ω", "–°–º–µ—à–∞–Ω–Ω–æ"], "single"),
        ("–ö–∞–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã?", ["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–ò—Å—Ç–æ—Ä–∏—è", "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏", "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"], "multiple"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è —É—Å–ø–µ—Ö–∞?", ["–î–∞", "–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã?", ["–†–µ–≥—É–ª—è—Ä–Ω–æ", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–ß–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –Ω–∞—É—á–Ω–æ-–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–Ω–∏–≥–∏?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –ï–ì–≠?", ["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ"], "single"),
    ],

    "–†–∞–±–æ—Ç–∞": [
        ("–†–∞–±–æ—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–π—á–∞—Å?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–í –∫–∞–∫–æ–π —Å—Ñ–µ—Ä–µ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ?", ["IT", "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "–ü—Ä–æ–¥–∞–∂–∏", "–î—Ä—É–≥–æ–µ"], "single"),
        ("–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º –≤–∞—à–∞ —Ä–∞–±–æ—Ç–∞?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –º–µ–Ω—è–µ—Ç–µ –º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã?", ["–†–∞–∑ –≤ –≥–æ–¥", "–†–∞–∑ –≤ 3 –≥–æ–¥–∞", "–†–µ–¥–∫–æ"], "single"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–±—è –∫–∞—Ä—å–µ—Ä–∏—Å—Ç–æ–º?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç–µ —Ä–∞–±–æ—Ç—É?", ["–°–∞–π—Ç—ã –≤–∞–∫–∞–Ω—Å–∏–π", "–ß–µ—Ä–µ–∑ –∑–Ω–∞–∫–æ–º—ã—Ö", "–°–∞–º–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ"], "multiple"),
        ("–ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã –≤–∞–º –±–ª–∏–∂–µ?", ["–û—Ñ–∏—Å", "–£–¥–∞–ª—ë–Ω–∫–∞", "–ì–∏–±—Ä–∏–¥"], "single"),
        ("–ö–∞–∫–æ–π —É –≤–∞—Å —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞ –Ω–∞ —Ä–∞–±–æ—Ç–µ?", ["–í—ã—Å–æ–∫–∏–π", "–°—Ä–µ–¥–Ω–∏–π", "–ù–∏–∑–∫–∏–π"], "single"),
        ("–î–æ–≤–æ–ª—å–Ω—ã –ª–∏ –≤—ã —Å–≤–æ–µ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–•–æ—Ç–µ–ª–∏ –±—ã –≤—ã –æ—Ç–∫—Ä—ã—Ç—å —Å–≤–æ–π –±–∏–∑–Ω–µ—Å?", ["–î–∞", "–ù–µ—Ç", "–ù–µ –∑–Ω–∞—é"], "single"),
    ],

    "–≠–∫–æ–ª–æ–≥–∏—è": [
        ("–°–æ—Ä—Ç–∏—Ä—É–µ—Ç–µ –ª–∏ –≤—ã –º—É—Å–æ—Ä?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã–µ —Å—É–º–∫–∏?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ –∑–∞—â–∏—Ç–µ –ø—Ä–∏—Ä–æ–¥—ã?", ["–ß–∞—Å—Ç–æ", "–ò–Ω–æ–≥–¥–∞", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–ö–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—è–º?", ["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ"], "single"),
        ("–ü–æ–ª—å–∑—É–µ—Ç–µ—Å—å –ª–∏ –≤—ã –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —ç–∫–æ–ª–æ–≥–∏—é –≤–∞–∂–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π?", ["–î–∞", "–û—Ç—á–∞—Å—Ç–∏", "–ù–µ—Ç"], "single"),
        ("–ì–æ—Ç–æ–≤—ã –ª–∏ –≤—ã –ø–ª–∞—Ç–∏—Ç—å –±–æ–ª—å—à–µ –∑–∞ —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–í—ã–∫–ª—é—á–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–≤–µ—Ç, –≤—ã—Ö–æ–¥—è –∏–∑ –∫–æ–º–Ω–∞—Ç—ã?", ["–í—Å–µ–≥–¥–∞", "–ò–Ω–æ–≥–¥–∞", "–†–µ–¥–∫–æ"], "single"),
        ("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–∏–µ –ª–∞–º–ø—ã?", ["–î–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–µ –æ—Ç—Ö–æ–¥–æ–≤?", ["–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é", "–ë–µ–∑—Ä–∞–∑–ª–∏—á–Ω–æ", "–°–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏"], "single"),
    ],

    "–û–±—â–µ—Å—Ç–≤–æ": [
        ("–î–æ–≤–µ—Ä—è–µ—Ç–µ –ª–∏ –≤—ã —Å—Ä–µ–¥—Å—Ç–≤–∞–º –º–∞—Å—Å–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤—É?", ["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ"], "single"),
        ("–°–ª–µ–¥–∏—Ç–µ –ª–∏ –≤—ã –∑–∞ –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–≤–æ–±–æ–¥—ã —Å–ª–æ–≤–∞?", ["–í—ã—Å–æ–∫–∏–π", "–°—Ä–µ–¥–Ω–∏–π", "–ù–∏–∑–∫–∏–π"], "single"),
        ("–ì–æ–ª–æ—Å—É–µ—Ç–µ –ª–∏ –≤—ã –Ω–∞ –≤—ã–±–æ—Ä–∞—Ö?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º –¥–ª—è –æ–±—â–µ—Å—Ç–≤–∞?", ["–î–∞", "–°–∫–æ—Ä–µ–µ –¥–∞", "–°–∫–æ—Ä–µ–µ –Ω–µ—Ç", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –ø–æ–º–æ–≥–∞–µ—Ç–µ –¥—Ä—É–≥–∏–º –ª—é–¥—è–º?", ["–ß–∞—Å—Ç–æ", "–ò–Ω–æ–≥–¥–∞", "–†–µ–¥–∫–æ", "–ù–∏–∫–æ–≥–¥–∞"], "single"),
        ("–î–æ–≤–µ—Ä—è–µ—Ç–µ –ª–∏ –≤—ã –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞–º?", ["–î–∞", "–ò–Ω–æ–≥–¥–∞", "–ù–µ—Ç"], "single"),
        ("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –º–∏–≥—Ä–∞–Ω—Ç–∞–º?", ["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ", "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ"], "single"),
    ],
}

def clear_database(conn, cur):
    print("üßπ –û—á–∏—â–∞—é —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ...")
    # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑-–∑–∞ foreign keys
    cur.execute("TRUNCATE TABLE otvet_polzovatelya RESTART IDENTITY CASCADE;")
    cur.execute("TRUNCATE TABLE sessiya RESTART IDENTITY CASCADE;")
    cur.execute("TRUNCATE TABLE variant_otveta RESTART IDENTITY CASCADE;")
    cur.execute("TRUNCATE TABLE vopros RESTART IDENTITY CASCADE;")
    cur.execute("TRUNCATE TABLE opros RESTART IDENTITY CASCADE;")
    conn.commit()
    print("–ë–∞–∑–∞ –æ—á–∏—â–µ–Ω–∞ ‚úÖ")

def fill_db_from_dict(data):
    conn = psycopg2.connect(**DB_CONFIG)
    cur = conn.cursor()
    
    clear_database(conn, cur)

    print("üöÄ –ó–∞–ø–æ–ª–Ω—è—é –±–∞–∑—É –Ω–æ–≤—ã–º–∏ –æ–ø—Ä–æ—Å–∞–º–∏...")
    for topic, questions in data.items():
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–æ–ª—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º DEFAULT –∑–Ω–∞—á–µ–Ω–∏—è
        cur.execute(
            "INSERT INTO opros (nazvanie, opisanie, data, dostup) VALUES (%s, %s, CURRENT_DATE, TRUE) RETURNING id_opros;",
            (topic, f"–û–ø—Ä–æ—Å –Ω–∞ —Ç–µ–º—É: {topic}")
        )
        id_opros = cur.fetchone()[0]

        for idx, (question, answers, q_type) in enumerate(questions, start=1):
            cur.execute(
                "INSERT INTO vopros (id_opros, tekst_vopros, poryadok, tip_voprosa) VALUES (%s, %s, %s, %s) RETURNING id_vopros;",
                (id_opros, question, idx, q_type)
            )
            id_vopros = cur.fetchone()[0]

            for ans in answers:
                cur.execute(
                    "INSERT INTO variant_otveta (id_vopros, tekst_otveta) VALUES (%s, %s);",
                    (id_vopros, ans)
                )

    conn.commit()
    cur.close()
    conn.close()
    print("‚úÖ –ë–∞–∑–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏!")

if __name__ == '__main__':
    fill_db_from_dict(surveys)
